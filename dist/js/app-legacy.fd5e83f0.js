(function(){"use strict";var n={2840:function(n,e,t){t(6992),t(8674),t(9601),t(7727);var a=t(9567),i=t(4549),o=t.n(i),r=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app",attrs:{id:"app"}},[t("peoples-tree",{staticClass:"app__tree",attrs:{peoples:n.peoples,expanded:n.expanded,loading:n.loading},on:{change:n.handleChange,click:n.handleNodeClick}}),t("a-map",{ref:"map",staticClass:"app__map",attrs:{points:n.points},on:{click:n.handleMarkerClick}})],1)},c=[],l=t(3019),s=(t(1539),t(1249),t(9826),t(2222),t(8783),t(3948),t(4747),t(8309),t(8862),t(7042),t(4916),t(4765),function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"a-map"},[t("div",{ref:"amap",staticClass:"a-map__map"}),t("div",{ref:"marker",staticClass:"a-map__marker"},[t("p",[n._v(n._s(n.current.id))]),t("p",[n._v(n._s(n.current.title))])])])}),u=[],d=t(9648),p=t.n(d),f={name:"AMap",data:function(){return{map:null,cluster:null,AMap:null,infoWindow:null,current:{id:"",title:""}}},props:{points:{type:Array,default:function(){return[]}}},mounted:function(){this.initMap()},watch:{points:function(n){var e=this,t=[];n.forEach((function(n){n.location?t.push({id:n.id,title:n.origin,lnglat:[n.location.lng,n.location.lat]}):console.log(n.id,n.origin)})),this.cluster&&this.cluster.setMap(null),this.cluster=new this.AMap.MarkerCluster(this.map,t,{gridSize:60}),this.cluster.on("click",(function(n){var t=n.clusterData,a=n.lnglat,i=t[0],o=i.id,r=i.title;e.current.id=o,e.current.title=r,e.infoWindow.open(e.map,a),e.$emit("click",{id:o,title:r})})),this.map.setFitView(null,!0),this.infoWindow.close()}},methods:{initMap:function(){var n=this,e=this.$refs.amap;p().load({key:"d786ac93724ce3d6658748d66cf5be5b",version:"2.0",plugins:["AMap.MarkerCluster","AMap.AutoComplete"]}).then((function(t){n.AMap=t,n.map=new t.Map(e,{viewMode:"2D",zoom:10,center:[118.144541,39.696604]});var a=n.$refs.marker;n.infoWindow=new t.InfoWindow({anchor:"top-left",content:a})})).catch((function(n){console.log(n)}))},searchPoint:function(n){var e={city:"唐山市"},t=new this.AMap.AutoComplete(e);return new Promise((function(e,a){t.search(n.name,(function(t,i){if("OK"===i.info){var o=i.tips[0],r=o.district,c=o.name,l=o.location,s={id:n.id,origin:n.name,district:r,name:c,location:{lng:l.lng,lat:l.lat}};e(s)}else a("err")}))}))},setCenter:function(n){var e=n.location;this.map.setZoomAndCenter(17,[e.lng,e.lat],!0)}}},h=f,m=t(1001),v=(0,m.Z)(h,s,u,!1,null,"4908f708",null),g=v.exports,k=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticClass:"peoples-tree",attrs:{"node-key":"id","default-expanded-keys":n.expanded,"show-checkbox":"",data:n.treeData,props:n.defaultProps},on:{check:n.handleCheck,"node-click":n.handleClick},scopedSlots:n._u([{key:"default",fn:function(e){var a=e.node,i=e.data;return t("span",{staticClass:"peoples-tree__label",class:{accurate0:3===a.level&&!i.accurate,accurate1:3===a.level&&1===i.accurate,accurate2:3===a.level&&2===i.accurate}},[n._v(" "+n._s(i.label)+" ")])}}])})},b=[],_=(t(2707),t(7327),{name:"PeoplesTree",data:function(){return{data:[],defaultProps:{label:"label",children:"children"}}},props:{peoples:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},expanded:{type:Array,default:function(){return[]}}},computed:{treeData:function(){var n=[],e=[];return this.peoples.forEach((function(t){var a,i=t.id.slice(0,1),o=t.id.slice(1);a="Q"===i?n:e;var r=t.track.map((function(n){return(0,l.Z)({label:n.origin||n.name},n)}));a.push({id:t.id,no:+o,label:"".concat(o," ").concat(t.area," (").concat(r.length,")"),children:r})})),n.sort((function(n,e){return n.no-e.no})),e.sort((function(n,e){return n.no-e.no})),[{id:"q",label:"确诊 [".concat(n.length,"]"),children:n},{id:"w",label:"无症状 [".concat(e.length,"]"),children:e}]}},methods:{handleCheck:function(n,e){var t=e.checkedNodes,a=t.filter((function(n){return!n.children}));this.$emit("change",a)},handleClick:function(n){n.location&&this.$emit("click",n)}}}),y=_,C=(0,m.Z)(y,k,b,!1,null,"5545651a",null),w=C.exports,M=t(6166),x=t.n(M),A=x().create({timeout:3e5}),O=A,P={name:"App",components:{PeoplesTree:w,AMap:g},data:function(){return{peoples:[],points:[],AMap:null,loading:!1,expanded:[],maxIndex:0}},created:function(){var n=this;p().load({key:"d786ac93724ce3d6658748d66cf5be5b",version:"2.0",plugins:["AMap.AutoComplete"]}).then((function(e){n.AMap=e,n.loadData()})).catch((function(n){console.log(n)}))},methods:{loadData:function(){var n=this;this.loading=!0,O.get("data/data.json").then((function(e){var t=e.data,a=[];n.maxIndex=t.positions.reduce((function(n,e){return n.rid>e.rid?n.rid:e.rid}));var i=t.peoples.map((function(e){var i=e.track.map((function(i,o){var r;return i.rid?r=(0,l.Z)((0,l.Z)({},i),t.positions.find((function(n){return n.rid===i.rid}))):(r=(0,l.Z)({},i),0!==i.accurate&&a.push(n.searchPoint(r))),r.id="".concat(e.id,"-").concat(o),r}));return(0,l.Z)((0,l.Z)({},e),{},{track:i})}));Promise.all(a).then((function(e){e.forEach((function(n){var e=n.data,t=n.pos;e.district=t.district,e.name=t.name,e.location=t.location,e.accurate=t.accurate})),n.peoples=i,n.loading=!1})).catch((function(n){console.log("err",n)}))}))},handleChange:function(n){this.points=n},handleNodeClick:function(n){var e=JSON.stringify({rid:++this.maxIndex,district:n.district,name:n.name,location:n.location});console.log(e),this.$refs.map.setCenter(n)},handleMarkerClick:function(n){this.expanded=[n.id.slice(0,5)]},searchPoint:function(n){var e=this,t={city:"唐山市"};return new Promise((function(a,i){var o=new e.AMap.AutoComplete(t);o.search(n.origin,(function(e,t){if(t){var o;if("OK"===t.info){var r=t.tips[0],c=r.district,l=r.name,s=r.location;o={district:c,name:l,location:{lng:s.lng,lat:s.lat},accurate:1}}else o={accurate:0};a({data:n,pos:o})}else i({status:e,result:t,origin:n.origin})}))}))}}},Z=P,$=(0,m.Z)(Z,r,c,!1,null,null,null),j=$.exports;window._AMapSecurityConfig={securityJsCode:"30eb50807133bec74365efaac53b226a"},a["default"].use(o()),a["default"].config.productionTip=!1,new a["default"]({render:function(n){return n(j)}}).$mount("#app")}},e={};function t(a){var i=e[a];if(void 0!==i)return i.exports;var o=e[a]={exports:{}};return n[a].call(o.exports,o,o.exports,t),o.exports}t.m=n,function(){var n=[];t.O=function(e,a,i,o){if(!a){var r=1/0;for(u=0;u<n.length;u++){a=n[u][0],i=n[u][1],o=n[u][2];for(var c=!0,l=0;l<a.length;l++)(!1&o||r>=o)&&Object.keys(t.O).every((function(n){return t.O[n](a[l])}))?a.splice(l--,1):(c=!1,o<r&&(r=o));if(c){n.splice(u--,1);var s=i();void 0!==s&&(e=s)}}return e}o=o||0;for(var u=n.length;u>0&&n[u-1][2]>o;u--)n[u]=n[u-1];n[u]=[a,i,o]}}(),function(){t.n=function(n){var e=n&&n.__esModule?function(){return n["default"]}:function(){return n};return t.d(e,{a:e}),e}}(),function(){t.d=function(n,e){for(var a in e)t.o(e,a)&&!t.o(n,a)&&Object.defineProperty(n,a,{enumerable:!0,get:e[a]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"===typeof window)return window}}()}(),function(){t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)}}(),function(){t.r=function(n){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}}(),function(){var n={143:0};t.O.j=function(e){return 0===n[e]};var e=function(e,a){var i,o,r=a[0],c=a[1],l=a[2],s=0;if(r.some((function(e){return 0!==n[e]}))){for(i in c)t.o(c,i)&&(t.m[i]=c[i]);if(l)var u=l(t)}for(e&&e(a);s<r.length;s++)o=r[s],t.o(n,o)&&n[o]&&n[o][0](),n[o]=0;return t.O(u)},a=self["webpackChunkcovid_19_ts"]=self["webpackChunkcovid_19_ts"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=t.O(void 0,[998],(function(){return t(2840)}));a=t.O(a)})();
//# sourceMappingURL=app-legacy.fd5e83f0.js.map