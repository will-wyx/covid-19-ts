(function(){"use strict";var t={3616:function(t,e,n){n(6992),n(8674),n(9601),n(7727);var a=n(9567),i=n(4549),o=n.n(i),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app",attrs:{id:"app"}},[n("peoples-tree",{staticClass:"app__tree",attrs:{peoples:t.peoples,expanded:t.expanded,loading:t.loading},on:{change:t.handleChange,click:t.handleNodeClick}}),n("a-map",{ref:"map",staticClass:"app__map",attrs:{points:t.points},on:{click:t.handleMarkerClick}})],1)},c=[],l=n(3019),s=(n(1249),n(9826),n(1539),n(2222),n(8783),n(3948),n(4747),n(8309),n(8862),n(7042),n(4916),n(4765),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"a-map"},[n("div",{ref:"amap",staticClass:"a-map__map"}),n("div",{ref:"marker",staticClass:"a-map__marker"},[n("p",[t._v(t._s(t.current.id))]),n("p",[t._v(t._s(t.current.title))])])])}),u=[],d=n(9648),p=n.n(d),f={name:"AMap",data:function(){return{map:null,cluster:null,AMap:null,infoWindow:null,current:{id:"",title:""}}},props:{points:{type:Array,default:function(){return[]}}},mounted:function(){this.initMap()},watch:{points:function(t){var e=this,n=[];t.forEach((function(t){t.location?n.push({id:t.id,title:t.origin,lnglat:[t.location.lng,t.location.lat]}):console.log(t.id,t.origin)})),this.cluster&&this.cluster.setMap(null),this.cluster=new this.AMap.MarkerCluster(this.map,n,{gridSize:60}),this.cluster.on("click",(function(t){var n=t.clusterData,a=t.lnglat,i=n[0],o=i.id,r=i.title;e.current.id=o,e.current.title=r,e.infoWindow.open(e.map,a),e.$emit("click",{id:o,title:r})})),this.map.setFitView(null,!0),this.infoWindow.close()}},methods:{initMap:function(){var t=this,e=this.$refs.amap;p().load({key:"d786ac93724ce3d6658748d66cf5be5b",version:"2.0",plugins:["AMap.MarkerCluster","AMap.AutoComplete"]}).then((function(n){t.AMap=n,t.map=new n.Map(e,{viewMode:"2D",zoom:10,center:[118.144541,39.696604]});var a=t.$refs.marker;t.infoWindow=new n.InfoWindow({anchor:"top-left",content:a})})).catch((function(t){console.log(t)}))},searchPoint:function(t){var e={city:"唐山市"},n=new this.AMap.AutoComplete(e);return new Promise((function(e,a){n.search(t.name,(function(n,i){if("OK"===i.info){var o=i.tips[0],r=o.district,c=o.name,l=o.location,s={id:t.id,origin:t.name,district:r,name:c,location:{lng:l.lng,lat:l.lat}};e(s)}else a("err")}))}))},setCenter:function(t){var e=t.location;this.map.setZoomAndCenter(17,[e.lng,e.lat],!0)}}},h=f,m=n(1001),v=(0,m.Z)(h,s,u,!1,null,"4908f708",null),g=v.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"peoples-tree",attrs:{"node-key":"id","default-expanded-keys":t.expanded,"show-checkbox":"",data:t.treeData,props:t.defaultProps},on:{check:t.handleCheck,"node-click":t.handleClick},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node,i=e.data;return n("span",{staticClass:"peoples-tree__label",class:{accurate0:3===a.level&&!i.accurate,accurate1:3===a.level&&1===i.accurate,accurate2:3===a.level&&2===i.accurate}},[t._v(" "+t._s(i.label)+" ")])}}])})},b=[],_=(n(2707),n(7327),{name:"PeoplesTree",data:function(){return{data:[],defaultProps:{label:"label",children:"children"}}},props:{peoples:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1},expanded:{type:Array,default:function(){return[]}}},computed:{treeData:function(){var t=[],e=[];return this.peoples.forEach((function(n){var a,i=n.id.slice(0,1),o=n.id.slice(1);a="Q"===i?t:e;var r=n.track.map((function(t){return(0,l.Z)({label:t.origin||t.name},t)}));a.push({id:n.id,no:+o,label:"".concat(o," ").concat(n.area," (").concat(r.length,")"),children:r})})),t.sort((function(t,e){return t.no-e.no})),e.sort((function(t,e){return t.no-e.no})),[{id:"q",label:"确诊 [".concat(t.length,"]"),children:t},{id:"w",label:"无症状 [".concat(e.length,"]"),children:e}]}},methods:{handleCheck:function(t,e){var n=e.checkedNodes,a=n.filter((function(t){return!t.children}));this.$emit("change",a)},handleClick:function(t){t.location&&this.$emit("click",t)}}}),y=_,C=(0,m.Z)(y,k,b,!1,null,"5545651a",null),w=C.exports,M=n(6166),A=n.n(M),x=A().create({timeout:3e5}),O=x,P={name:"App",components:{PeoplesTree:w,AMap:g},data:function(){return{peoples:[],points:[],AMap:null,loading:!1,expanded:[]}},created:function(){var t=this;p().load({key:"d786ac93724ce3d6658748d66cf5be5b",version:"2.0",plugins:["AMap.AutoComplete"]}).then((function(e){t.AMap=e,t.loadData()})).catch((function(t){console.log(t)}))},methods:{loadData:function(){var t=this;this.loading=!0,O.get("data/data.json").then((function(e){var n=e.data,a=[],i=n.peoples.map((function(e){var i=e.track.map((function(i,o){var r;return i.rid?r=(0,l.Z)((0,l.Z)({},i),n.positions.find((function(t){return t.rid===i.rid}))):(r=(0,l.Z)({},i),0!==i.accurate&&a.push(t.searchPoint(r))),r.id="".concat(e.id,"-").concat(o),r}));return(0,l.Z)((0,l.Z)({},e),{},{track:i})}));Promise.all(a).then((function(e){e.forEach((function(t){var e=t.data,n=t.pos;e.district=n.district,e.name=n.name,e.location=n.location,e.accurate=n.accurate})),t.peoples=i,t.loading=!1})).catch((function(t){console.log("err",t)}))}))},handleChange:function(t){this.points=t},handleNodeClick:function(t){var e=JSON.stringify({district:t.district,name:t.name,location:t.location});console.log(e),this.$refs.map.setCenter(t)},handleMarkerClick:function(t){this.expanded=[t.id.slice(0,5)]},searchPoint:function(t){var e=this,n={city:"唐山市"};return new Promise((function(a,i){var o=new e.AMap.AutoComplete(n);o.search(t.origin,(function(e,n){if(n){var o;if("OK"===n.info){var r=n.tips[0],c=r.district,l=r.name,s=r.location;o={district:c,name:l,location:{lng:s.lng,lat:s.lat},accurate:1}}else o={accurate:0};a({data:t,pos:o})}else i({status:e,result:n,origin:t.origin})}))}))}}},Z=P,$=(0,m.Z)(Z,r,c,!1,null,null,null),j=$.exports;window._AMapSecurityConfig={securityJsCode:"30eb50807133bec74365efaac53b226a"},a["default"].use(o()),a["default"].config.productionTip=!1,new a["default"]({render:function(t){return t(j)}}).$mount("#app")}},e={};function n(a){var i=e[a];if(void 0!==i)return i.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,n),o.exports}n.m=t,function(){var t=[];n.O=function(e,a,i,o){if(!a){var r=1/0;for(u=0;u<t.length;u++){a=t[u][0],i=t[u][1],o=t[u][2];for(var c=!0,l=0;l<a.length;l++)(!1&o||r>=o)&&Object.keys(n.O).every((function(t){return n.O[t](a[l])}))?a.splice(l--,1):(c=!1,o<r&&(r=o));if(c){t.splice(u--,1);var s=i();void 0!==s&&(e=s)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[a,i,o]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,a){var i,o,r=a[0],c=a[1],l=a[2],s=0;if(r.some((function(e){return 0!==t[e]}))){for(i in c)n.o(c,i)&&(n.m[i]=c[i]);if(l)var u=l(n)}for(e&&e(a);s<r.length;s++)o=r[s],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(u)},a=self["webpackChunkcovid_19_ts"]=self["webpackChunkcovid_19_ts"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(3616)}));a=n.O(a)})();
//# sourceMappingURL=app-legacy.29199733.js.map