(function(){"use strict";var e={4047:function(e,n,t){t(6992),t(8674),t(9601),t(7727);var a=t(9567),o=t(4549),i=t.n(o),r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"app",attrs:{id:"app"}},[t("peoples-tree",{staticClass:"app__tree",attrs:{peoples:e.peoples,loading:e.loading},on:{change:e.handleChange,click:e.handleNodeClick}}),t("a-map",{ref:"map",staticClass:"app__map",attrs:{points:e.points}})],1)},c=[],l=(t(1539),t(4747),t(8783),t(3948),t(8862),t(8309),t(1249),t(4916),t(4765),function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{ref:"amap",staticClass:"a-map"})}),s=[],u=t(9648),p=t.n(u),f={name:"AMap",data:function(){return{map:null,cluster:null,AMap:null}},props:{points:{type:Array,default:function(){return[]}}},mounted:function(){this.initMap()},watch:{points:function(e){var n=[];e.forEach((function(e){e.location?n.push({id:e.id,lnglat:[e.location.lng,e.location.lat]}):console.log(e.id,e.name)})),this.cluster&&this.cluster.setMap(null),this.cluster=new this.AMap.MarkerCluster(this.map,n,{gridSize:60}),this.map.setFitView(null,!0)}},methods:{initMap:function(){var e=this,n=this.$refs.amap;p().load({key:"d786ac93724ce3d6658748d66cf5be5b",version:"2.0",plugins:["AMap.MarkerCluster","AMap.AutoComplete"]}).then((function(t){e.AMap=t,e.map=new t.Map(n,{viewMode:"2D",zoom:10,center:[118.144541,39.696604]})})).catch((function(e){console.log(e)}))},searchPoint:function(e){var n={city:"唐山市"},t=new this.AMap.AutoComplete(n);return new Promise((function(n,a){t.search(e.name,(function(t,o){if("OK"===o.info){var i=o.tips[0],r=i.district,c=i.name,l=i.location,s={id:e.id,origin:e.name,district:r,name:c,location:{lng:l.lng,lat:l.lat}};n(s)}else a("err")}))}))},setCenter:function(e){var n=e.location;this.map.setZoomAndCenter(17,[n.lng,n.lat],!0)}}},d=f,h=t(1001),m=(0,h.Z)(d,l,s,!1,null,"1c41bc72",null),v=m.exports,g=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"peoples-tree",attrs:{"node-key":"id","show-checkbox":"",data:e.treeData,props:e.defaultProps},on:{check:e.handleCheck,"node-click":e.handleClick},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.node,o=n.data;return t("span",{staticClass:"peoples-tree__label",class:{accurate0:3===a.level&&!o.accurate,accurate1:3===a.level&&1===o.accurate,accurate2:3===a.level&&2===o.accurate}},[e._v(" "+e._s(o.label)+" ")])}}])})},b=[],y=t(3019),k=(t(7042),t(2222),t(2707),t(7327),{name:"PeoplesTree",data:function(){return{data:[],defaultProps:{label:"label",children:"children"}}},props:{peoples:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},computed:{treeData:function(){var e=[],n=[];return this.peoples.forEach((function(t){var a,o=t.id.slice(0,1),i=t.id.slice(1);a="Q"===o?e:n;var r=t.track.map((function(e,n){var a;return a=e instanceof Object?(0,y.Z)({id:"".concat(t.id,"-").concat(n),label:e.name},e):{id:"".concat(t.id,"-").concat(n),label:e,name:e},a}));a.push({id:t.id,no:+i,label:"".concat(i," ").concat(t.area," (").concat(r.length,")"),children:r})})),e.sort((function(e,n){return e.no-n.no})),n.sort((function(e,n){return e.no-n.no})),[{id:"q",label:"确诊 [".concat(e.length,"]"),children:e},{id:"w",label:"无症状 [".concat(n.length,"]"),children:n}]}},methods:{handleCheck:function(e,n){var t=n.checkedNodes,a=t.filter((function(e){return!e.children}));this.$emit("change",a)},handleClick:function(e){e.location&&this.$emit("click",e)}}}),C=k,w=(0,h.Z)(C,g,b,!1,null,"7d7f0036",null),_=w.exports,M=t(6166),A=t.n(M),O=A().create({timeout:3e3}),P=O,x={name:"App",components:{PeoplesTree:_,AMap:v},data:function(){return{peoples:[],points:[],AMap:null,loading:!1}},created:function(){var e=this;p().load({key:"d786ac93724ce3d6658748d66cf5be5b",version:"2.0",plugins:["AMap.AutoComplete"]}).then((function(n){e.AMap=n,e.loadData()})).catch((function(e){console.log(e)}))},methods:{loadData:function(){var e=this;this.loading=!0,P.get("data/data.json").then((function(n){var t=n.data,a=[];t.peoples.forEach((function(n){n.track.forEach((function(t,o){t.location||a.push(e.searchPoint(n,o,t))}))})),Promise.all(a).then((function(n){n.forEach((function(e){var n=e.people,t=e.index,a=e.pos;n.track[t]=a})),e.peoples=t.peoples,e.loading=!1})).catch((function(e){console.log("err",e)}))}))},handleChange:function(e){this.points=e},handleNodeClick:function(e){var n=JSON.stringify({district:e.district,name:e.name,origin:e.origin,location:e.location,accurate:2});console.log(n),this.$refs.map.setCenter(e)},searchPoint:function(e,n,t){var a=this,o={city:"唐山市"};return new Promise((function(i,r){var c=new a.AMap.AutoComplete(o);c.search(t,(function(a,o){if(o){var c;if("OK"===o.info){var l=o.tips[0],s=l.district,u=l.name,p=l.location;c={origin:t,district:s,name:u,location:{lng:p.lng,lat:p.lat},accurate:1}}else c={origin:t,name:t};i({people:e,index:n,pos:c})}else r({status:a,result:o,keywords:t})}))}))}}},j=x,E=(0,h.Z)(j,r,c,!1,null,null,null),S=E.exports;window._AMapSecurityConfig={securityJsCode:"30eb50807133bec74365efaac53b226a"},a["default"].use(i()),a["default"].config.productionTip=!1,new a["default"]({render:function(e){return e(S)}}).$mount("#app")}},n={};function t(a){var o=n[a];if(void 0!==o)return o.exports;var i=n[a]={exports:{}};return e[a].call(i.exports,i,i.exports,t),i.exports}t.m=e,function(){var e=[];t.O=function(n,a,o,i){if(!a){var r=1/0;for(u=0;u<e.length;u++){a=e[u][0],o=e[u][1],i=e[u][2];for(var c=!0,l=0;l<a.length;l++)(!1&i||r>=i)&&Object.keys(t.O).every((function(e){return t.O[e](a[l])}))?a.splice(l--,1):(c=!1,i<r&&(r=i));if(c){e.splice(u--,1);var s=o();void 0!==s&&(n=s)}}return n}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[a,o,i]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(n){return 0===e[n]};var n=function(n,a){var o,i,r=a[0],c=a[1],l=a[2],s=0;if(r.some((function(n){return 0!==e[n]}))){for(o in c)t.o(c,o)&&(t.m[o]=c[o]);if(l)var u=l(t)}for(n&&n(a);s<r.length;s++)i=r[s],t.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return t.O(u)},a=self["webpackChunkcovid_19_ts"]=self["webpackChunkcovid_19_ts"]||[];a.forEach(n.bind(null,0)),a.push=n.bind(null,a.push.bind(a))}();var a=t.O(void 0,[998],(function(){return t(4047)}));a=t.O(a)})();
//# sourceMappingURL=app-legacy.5ae09ef5.js.map