(function(){"use strict";var n={4263:function(n,e,t){t(6992),t(8674),t(9601),t(7727);var a=t(9567),o=t(4549),i=t.n(o),r=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app",attrs:{id:"app"}},[t("peoples-tree",{staticClass:"app__tree",attrs:{peoples:n.peoples,loading:n.loading},on:{change:n.handleChange,click:n.handleNodeClick}}),t("a-map",{ref:"map",staticClass:"app__map",attrs:{points:n.points}})],1)},c=[],l=(t(1539),t(4747),t(1249),t(9826),t(8783),t(3948),t(8862),t(8309),t(4916),t(4765),function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{ref:"amap",staticClass:"a-map"})}),s=[],u=t(9648),p=t.n(u),f={name:"AMap",data:function(){return{map:null,cluster:null,AMap:null}},props:{points:{type:Array,default:function(){return[]}}},mounted:function(){this.initMap()},watch:{points:function(n){var e=[];n.forEach((function(n){n.location?e.push({id:n.id,lnglat:[n.location.lng,n.location.lat]}):console.log(n.id,n.name)})),this.cluster&&this.cluster.setMap(null),this.cluster=new this.AMap.MarkerCluster(this.map,e,{gridSize:60}),this.map.setFitView(null,!0)}},methods:{initMap:function(){var n=this,e=this.$refs.amap;p().load({key:"d786ac93724ce3d6658748d66cf5be5b",version:"2.0",plugins:["AMap.MarkerCluster","AMap.AutoComplete"]}).then((function(t){n.AMap=t,n.map=new t.Map(e,{viewMode:"2D",zoom:10,center:[118.144541,39.696604]})})).catch((function(n){console.log(n)}))},searchPoint:function(n){var e={city:"唐山市"},t=new this.AMap.AutoComplete(e);return new Promise((function(e,a){t.search(n.name,(function(t,o){if("OK"===o.info){var i=o.tips[0],r=i.district,c=i.name,l=i.location,s={id:n.id,origin:n.name,district:r,name:c,location:{lng:l.lng,lat:l.lat}};e(s)}else a("err")}))}))},setCenter:function(n){var e=n.location;this.map.setZoomAndCenter(17,[e.lng,e.lat],!0)}}},d=f,h=t(1001),m=(0,h.Z)(d,l,s,!1,null,"1c41bc72",null),v=m.exports,g=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticClass:"peoples-tree",attrs:{"node-key":"id","show-checkbox":"",data:n.treeData,props:n.defaultProps},on:{check:n.handleCheck,"node-click":n.handleClick},scopedSlots:n._u([{key:"default",fn:function(e){var a=e.node,o=e.data;return t("span",{staticClass:"peoples-tree__label",class:{accurate0:3===a.level&&!o.accurate,accurate1:3===a.level&&1===o.accurate,accurate2:3===a.level&&2===o.accurate}},[n._v(" "+n._s(o.label)+" ")])}}])})},b=[],y=t(3019),k=(t(7042),t(2222),t(2707),t(7327),{name:"PeoplesTree",data:function(){return{data:[],defaultProps:{label:"label",children:"children"}}},props:{peoples:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},computed:{treeData:function(){var n=[],e=[];return this.peoples.forEach((function(t){var a,o=t.id.slice(0,1),i=t.id.slice(1);a="Q"===o?n:e;var r=t.track.map((function(n,e){var a;return a=n instanceof Object?(0,y.Z)({id:"".concat(t.id,"-").concat(e),label:n.name},n):{id:"".concat(t.id,"-").concat(e),label:n,name:n},a}));a.push({id:t.id,no:+i,label:"".concat(i," ").concat(t.area," (").concat(r.length,")"),children:r})})),n.sort((function(n,e){return n.no-e.no})),e.sort((function(n,e){return n.no-e.no})),[{id:"q",label:"确诊 [".concat(n.length,"]"),children:n},{id:"w",label:"无症状 [".concat(e.length,"]"),children:e}]}},methods:{handleCheck:function(n,e){var t=e.checkedNodes,a=t.filter((function(n){return!n.children}));this.$emit("change",a)},handleClick:function(n){n.location&&this.$emit("click",n)}}}),C=k,w=(0,h.Z)(C,g,b,!1,null,"7d7f0036",null),_=w.exports,M=t(6166),A=t.n(M),O=A().create({timeout:3e5}),P=O,x={name:"App",components:{PeoplesTree:_,AMap:v},data:function(){return{peoples:[],points:[],AMap:null,loading:!1}},created:function(){var n=this;p().load({key:"d786ac93724ce3d6658748d66cf5be5b",version:"2.0",plugins:["AMap.AutoComplete"]}).then((function(e){n.AMap=e,n.loadData()})).catch((function(n){console.log(n)}))},methods:{loadData:function(){var n=this;this.loading=!0,P.get("data/data.json").then((function(e){var t=e.data,a=[],o=t.peoples,i=t.positions;o.forEach((function(e){e.track=e.track.map((function(t,o){return"number"===typeof t?i.find((function(n){return n.id===t})):(t.location||a.push(n.searchPoint(e,o,t)),t)}))})),Promise.all(a).then((function(e){e.forEach((function(n){var e=n.people,t=n.index,a=n.pos;e.track[t]=a})),n.peoples=t.peoples,n.loading=!1})).catch((function(n){console.log("err",n)}))}))},handleChange:function(n){this.points=n},handleNodeClick:function(n){var e=JSON.stringify({district:n.district,name:n.name,origin:n.origin,location:n.location,accurate:2});console.log(e),this.$refs.map.setCenter(n)},searchPoint:function(n,e,t){var a=this,o={city:"唐山市"};return new Promise((function(i,r){var c=new a.AMap.AutoComplete(o);c.search(t,(function(a,o){if(o){var c;if("OK"===o.info){var l=o.tips[0],s=l.district,u=l.name,p=l.location;c={origin:t,district:s,name:u,location:{lng:p.lng,lat:p.lat},accurate:1}}else c={origin:t,name:t};i({people:n,index:e,pos:c})}else r({status:a,result:o,keywords:t})}))}))}}},j=x,S=(0,h.Z)(j,r,c,!1,null,null,null),E=S.exports;window._AMapSecurityConfig={securityJsCode:"30eb50807133bec74365efaac53b226a"},a["default"].use(i()),a["default"].config.productionTip=!1,new a["default"]({render:function(n){return n(E)}}).$mount("#app")}},e={};function t(a){var o=e[a];if(void 0!==o)return o.exports;var i=e[a]={exports:{}};return n[a].call(i.exports,i,i.exports,t),i.exports}t.m=n,function(){var n=[];t.O=function(e,a,o,i){if(!a){var r=1/0;for(u=0;u<n.length;u++){a=n[u][0],o=n[u][1],i=n[u][2];for(var c=!0,l=0;l<a.length;l++)(!1&i||r>=i)&&Object.keys(t.O).every((function(n){return t.O[n](a[l])}))?a.splice(l--,1):(c=!1,i<r&&(r=i));if(c){n.splice(u--,1);var s=o();void 0!==s&&(e=s)}}return e}i=i||0;for(var u=n.length;u>0&&n[u-1][2]>i;u--)n[u]=n[u-1];n[u]=[a,o,i]}}(),function(){t.n=function(n){var e=n&&n.__esModule?function(){return n["default"]}:function(){return n};return t.d(e,{a:e}),e}}(),function(){t.d=function(n,e){for(var a in e)t.o(e,a)&&!t.o(n,a)&&Object.defineProperty(n,a,{enumerable:!0,get:e[a]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"===typeof window)return window}}()}(),function(){t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)}}(),function(){t.r=function(n){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})}}(),function(){var n={143:0};t.O.j=function(e){return 0===n[e]};var e=function(e,a){var o,i,r=a[0],c=a[1],l=a[2],s=0;if(r.some((function(e){return 0!==n[e]}))){for(o in c)t.o(c,o)&&(t.m[o]=c[o]);if(l)var u=l(t)}for(e&&e(a);s<r.length;s++)i=r[s],t.o(n,i)&&n[i]&&n[i][0](),n[i]=0;return t.O(u)},a=self["webpackChunkcovid_19_ts"]=self["webpackChunkcovid_19_ts"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=t.O(void 0,[998],(function(){return t(4263)}));a=t.O(a)})();
//# sourceMappingURL=app-legacy.78b2d5c6.js.map